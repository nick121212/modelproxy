!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("url-search-params"),require("path-to-regexp")):"function"==typeof define&&define.amd?define(["url-search-params","path-to-regexp"],e):"object"==typeof exports?exports.modelproxy=e(require("url-search-params"),require("path-to-regexp")):t.modelproxy=e(t.URLSearchParams,t.pathToRegexp)}(window,function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}},i=!0;try{t[r].call(o.exports,o,o.exports,n),i=!1}finally{i&&delete e[r]}return o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=11)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=function(){function t(){this.instances={}}return t.prototype.add=function(t,e,n){if(void 0===n&&(n=!1),n&&this.instances.hasOwnProperty(t))return console.error("已经存在name=【"+t+"】的engine！");this.instances[t]=e},t.prototype.remove=function(t){this.has(t)&&delete this.instances[t]},t.prototype.has=function(t){return!!this.get(t)},t.prototype.get=function(t){return this.instances.hasOwnProperty(t)?this.instances[t]:null},t.prototype.use=function(t){if(!t||!this.instances.hasOwnProperty(t)){var e=Object.keys(this.instances);throw new r.ModelProxyMissingError("不存在name=【"+t+"】的engine！当前engines：【"+e.join(",")+"】")}return this.instances[t]},t.prototype.forEach=function(t){if(t&&t.constructor===Function)for(var e in this.instances)this.instances.hasOwnProperty(e)&&t(e,this.instances[e])},t}();e.BaseFactory=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}s((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.middlewares=t.slice()}return t.prototype.use=function(t){if("function"!=typeof t)throw new TypeError("middleware must be a function！");this.middlewares.push(t)},t.prototype.clear=function(){this.middlewares.length=0},t.prototype.compose=function(){var t=this,e=this.middlewares;if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");for(var n=0,i=e;n<i.length;n++)if("function"!=typeof i[n])throw new TypeError("Middleware must be composed of functions!");return function(n,i){return new Promise(function(a,c){var s=-1,u=function(f){return r(t,void 0,void 0,function(){var t,l,p=this;return o(this,function(h){switch(h.label){case 0:if(t=e[f],f<=s)return[2,c(new Error("next() called multiple times"+f+"-"+s))];if(s=f,f===e.length&&(t=i),!t)return[2,n];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,t(n,function(t){return r(p,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return"abort"===t?[2,a(n)]:[4,u(f+1)];case 1:return e.sent(),[2]}})})})];case 2:return h.sent(),[3,4];case 3:return l=h.sent(),c(l),[3,4];case 4:return[2]}})})};return u(0).then(a.bind(n))})}},t.prototype.getMiddlewares=function(){return this.middlewares.concat([])},t.prototype.merge=function(t,e){var n=this;void 0===e&&(e=!1);var r=[];return t.getMiddlewares().forEach(function(t){e?r.push(t):n.use(t)}),this.middlewares=r.concat(this.middlewares),this},t.prototype.errorHandle=function(t,e){t.isError=!0,t.err=e},t.prototype.callback=function(t){var e=this,n=this.compose();return function(t){return r(e,void 0,void 0,function(){var e,i,a=this;return o(this,function(c){switch(c.label){case 0:e=Object.assign(t||{},{}),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n(e,function(t,n){return r(a,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,n()];case 1:if(t.sent(),e.isError)throw e.err;return[2]}})})})];case 2:return c.sent(),[3,4];case 3:return i=c.sent(),this.errorHandle(e,i),[3,4];case 4:return[2,e]}})})}},t}();e.Compose=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){this.name="",this.message=t||"",this.stack=(new Error).stack};e.BaseError=o;var i=function(t){function e(e){var n=t.call(this,e)||this;return n.name="ModelProxy.MissingError",n}return r(e,t),e}(o);e.ModelProxyMissingError=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(5);e.engineFactory=new r.BaseFactory,e.engineFactory.add("default",new o.DefaultEngine)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}s((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(8),c=n(7),s=n(1),u=n(2),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.validate=function(t,e){return o(this,void 0,void 0,function(){return i(this,function(t){return[2,!0]})})},e.prototype.delay=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,new Promise(function(e,n){setTimeout(function(){e()},t)})]})})},e.prototype.proxy=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return o(this,void 0,void 0,function(){return i(this,function(n){return t.getPath(e.instance),[2,{}]})})},e.prototype.getStatePath=function(t){return t.states&&t.state&&t.states[t.state]||""},e.prototype.replacePath=function(t,e){var n=e.params,r=void 0===n?[]:n,o=e.data,i=void 0===o?{}:o,c=[];return a.parse(t.path).forEach(function(t){var e=t.name;if(e){if(!r[e]&&!i[e])throw new u.ModelProxyMissingError("缺少["+e+"]字段！");c.push("/"+(r[e]||i[e])),delete r[e]}else c.push(t)}),c.join("")},e.prototype.getFullPath=function(t,e){var n=[this.getStatePath(t),this.replacePath(t,e)],r=new c;if(e.params){Object.keys(e.params).forEach(function(t){r.append(t,e.params[t])});var o=r.toString();o&&n.push("?"+o)}return n.join("")},e}(s.Compose);e.BaseEngine=f},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}s((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(4),c=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.doProxy=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return o(this,void 0,void 0,function(){var r,o,a,s,u;return i(this,function(i){switch(i.label){case 0:return r=new c.Compose,o=e.before,a=e.after,s=e.error,o&&r.merge(o),r.merge(this),a&&r.merge(a),[4,r.callback()(Object.assign.apply(Object,[{}].concat(n,[{executeInfo:e,instance:t}])))];case 1:return(u=i.sent()).isError?s?[4,s.callback()(u).catch(function(){})]:[3,3]:[3,4];case 2:i.sent(),i.label=3;case 3:throw u.err;case 4:return[2,u]}})})},e.prototype.proxy=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.doProxy.apply(this,[t,e].concat(n))]})})},e}(a.BaseEngine);e.DefaultEngine=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.promiseFactory=new r.BaseFactory,e.cacheDec=function(t,n,r){var o=n.executeInfo,i=void 0===o?{}:o,a=n.instance,c=i.settings||{},s=c.cache,u=void 0!==s&&s,f=c.reload,l=void 0!==f&&f,p=c.expire,h=void 0===p?void 0:p,y=(a||{}).method,d=r+(void 0===y?"":y);if(!u)return t();l&&e.promiseFactory.remove(d);var v=e.promiseFactory.get(d)||{},b=v.promise,g=void 0===b?null:b,w=v.expire,m=void 0===w?null:w,_=v.cacheIn,x=void 0===_?0:_;if(m&&x&&x+m<Date.now()&&(e.promiseFactory.remove(d),g=null),g)return n.fromCache=!0,g;var P=t();return e.promiseFactory.add(d,{promise:P,expire:h,cacheIn:Date.now()}),P}},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}s((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),c=n(3),s=function(t){function e(e){var n=t.call(this)||this;return n.overrideInterfaceConfig=e,n}return r(e,t),e.prototype.add=function(e,n,r){void 0===r&&(r=!1),t.prototype.add.call(this,e,Object.assign(n,{delete:this.custom.bind(this,n,"DELETE"),execute:this.execute.bind(this,n),get:this.custom.bind(this,n,"GET",null),getFullPath:this.getFullPath.bind(this,n),getOne:this.custom.bind(this,n,"GET"),getPath:this.getPath.bind(this,n),post:this.custom.bind(this,n,"POST",null),put:this.custom.bind(this,n,"PUT"),replacePath:this.replacePath.bind(this,n)}),r)},e.prototype.execute=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return o(this,void 0,void 0,function(){var r,o,a,s,u,f,l;return i(this,function(i){switch(i.label){case 0:if(a=e.instance,s=void 0===a?{}:a,o=this.megreInstance(t,s),u=o.engine,f=o.defaultExecuteInfo,l=void 0===f?{}:f,!c.engineFactory.has(u||""))throw new Error("没有发现engine["+u+"]");r=c.engineFactory.use(u||"default"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.validate(o,e)];case 2:return i.sent(),[3,4];case 3:throw i.sent();case 4:return[2,r.proxy.apply(r,[o,Object.assign({},l,e)].concat(n))]}})})},e.prototype.custom=function(t,e,n,r){void 0===r&&(r={});for(var a=[],c=4;c<arguments.length;c++)a[c-4]=arguments[c];return o(this,void 0,void 0,function(){var o,c,s,u;return i(this,function(i){switch(i.label){case 0:return o=r.instance,c=void 0===o?{}:o,s=r.params,u=void 0===s?{}:s,c.method=e,n&&(c.path=(c.path||t.path)+"/:__id__",u.__id__=n),r.instance=c,r.params=u,[4,this.execute.apply(this,[t,r].concat(a))];case 1:return[2,i.sent()]}})})},e.prototype.megreInstance=function(t,e){return void 0===e&&(e={}),Object.assign({},t,e)},e.prototype.executeEngineMethod=function(t,e,n,r){var o,i,a;return void 0===e&&(e={}),void 0===r&&(r={}),a=this.megreInstance(t,e),(i=(o=c.engineFactory.use("default"))[n])?i.call(o,a,r):""},e.prototype.getPath=function(t,e){var n;return void 0===e&&(e={}),n=this.megreInstance(t,e),this.executeEngineMethod(t,e,"getStatePath")+n.path},e.prototype.getFullPath=function(t,e){return void 0===e&&(e={}),this.executeEngineMethod(t,e.instance,"getFullPath",e)},e.prototype.replacePath=function(t,e){var n;return void 0===e&&(e={}),n=this.megreInstance(t,e.instance),c.engineFactory.use("default").replacePath(n,e)},e}(a.BaseFactory);e.InterfaceFactory=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}s((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(9),c=n(3),s=n(1),u=n(2),f=n(0),l=function(t){function e(e){var n=t.call(this)||this;return n.defaultExecuteInfo=e,n.nsFactory=new f.BaseFactory,n.forEach=n.nsFactory.forEach.bind(n.nsFactory),n}return r(e,t),e.prototype.addEngines=function(t){for(var e in t)t.hasOwnProperty(e)&&c.engineFactory.add(e,t[e],!0);return this},e.prototype.loadConfig=function(t,e){void 0===e&&(e={});var n=this.nsFactory.get(t.key);return n||(n=new a.InterfaceFactory(Object.assign({state:t.state,states:t.states,version:t.version},e))),this.nsFactory.add(t.key,this.initInterfaces(n,t,Object.assign({},n.overrideInterfaceConfig||{},e))),this},e.prototype.execute=function(t,e,n){void 0===n&&(n={});for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];return o(this,void 0,void 0,function(){var o,a;return i(this,function(i){if(o=this.getNs(t),!(a=o.get(e)))throw new u.ModelProxyMissingError("没有发现/"+t+"/"+e+"的接口方法！");return[2,a.execute.apply(a,[n].concat(r))]})})},e.prototype.executeAll=function(t){return o(this,void 0,void 0,function(){var e;return i(this,function(n){return e=[],t&&Object.keys(t).length?(Object.keys(t).forEach(function(n){e.push(t[n]().then(function(t){return(e={})[n]=t,e;var e}))}),[2,Promise.all(e).then(function(t){return t.reduce(function(t,e){return Object.assign({},t,e)})})]):[2,new Promise(function(t){t(null)})]})})},e.prototype.race=function(t){return o(this,void 0,void 0,function(){var e,n=this;return i(this,function(r){return e=t.map(function(t){if(t.then)return t;var e=t,r=e.ns,o=void 0===r?"":r,i=e.key,a=void 0===i?"":i,c=e.options,s=void 0===c?{}:c,u=e.otherOptions,f=void 0===u?[]:u;return n.execute.apply(n,[o,a,s].concat(f))}),[2,Promise.race(e)]})})},e.prototype.hasNs=function(t){return!!this.nsFactory.get(t)},e.prototype.getNs=function(t){if(!this.nsFactory.has(t))throw new u.ModelProxyMissingError("没有找到"+t+"空间;");return this.nsFactory.use(t)},e.prototype.mixin=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!e.length)throw new u.ModelProxyMissingError("必须制定至少一个Key！");var r=this.getNs(t),o=[],i=e.pop(),a=r.get(i);return a?(e.forEach(function(e){var n=r.get(e);if(!n)throw new u.ModelProxyMissingError(e+"不存在于空间"+t+"！");o.push(n)}),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==o.length)throw new Error("传入的参数个数不正确！");var n=[];return o.forEach(function(e,r){var o;n.push(e.replacePath({instance:{path:e.path+"/:"+e.key},params:(o={},o[e.key]=t[r],o)}))}),a.path=n.concat([a.path]).join(""),a}):null},e.prototype.initInterfaces=function(t,e,n){var r=this;return void 0===n&&(n={}),e.interfaces.forEach(function(o){var i=Object.assign({},{defaultExecuteInfo:r.defaultExecuteInfo,engine:e.engine,mockDir:e.mockDir,ns:e.key,state:e.state,states:e.states},o,n||{});t.add(o.key,i,!0)}),t},e}(s.Compose);e.ModelProxy=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(10);e.ModelProxy=r.ModelProxy;var o=n(1);e.Compose=o.Compose;var i=n(3);e.engineFactory=i.engineFactory;var a=n(2);e.BaseError=a.BaseError,e.ModelProxyMissingError=a.ModelProxyMissingError;var c=n(4);e.BaseEngine=c.BaseEngine;var s=n(5);e.DefaultEngine=s.DefaultEngine;var u=n(0);e.BaseFactory=u.BaseFactory;var f=n(6);e.cacheDec=f.cacheDec,e.promiseFactory=f.promiseFactory}])});
//# sourceMappingURL=index.map